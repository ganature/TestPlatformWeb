{% extends 'base.html' %}
{% block right_content %}

    <div class="col-md-10">
{#        <div class="panel-body" style="padding-bottom:0px;">#}
{#            <div class="panel panel-default">#}
{#                <div class="panel-heading">查询条件</div>#}
{#                <div class="panel-body">#}
{#                    <form id="formSearch" class="form-inline" action=" " method="get" role="form">#}
{#                        <div class="form-group" style="">#}
{#                            <label class=" col-sm-4" for="project_name">项目名称</label>#}
{#                            <div class="col-sm-4">#}
{#                                <input type="text" class="form-control" id="project_name" name="project_name">#}
{#                            </div>#}
{#                            </div>#}
{#                        <div class="form-group">#}
{#                            <label class=" col-sm-4" for="project_type">项目类型</label>#}
{##}
{#                            <div class="col-sm-4 ">#}
{#                                <select class="selectpicker bla bli form-control col-sm-4 " data-live-search="true" style="display: none" id="project_type" name="project_type">#}
{##}
{#                                    <option value="web">Web自动化</option>#}
{#                                    <option value="app">App自动化</option>#}
{#                                    <option value="inface">接口自动化</option>#}
{#                                </select>#}
{#                            </div>#}
{#                            <div class="col-sm-1" style="text-align:left;">#}
{#                                <button type="submit" style="margin-left:50px" id="btn_query" class="btn btn-primary">#}
{#                                    查询#}
{#                                </button>#}
{#                            </div>#}
{#                        </div>#}
{#                    </form>#}
{#                </div>#}
{#            </div>#}
{##}
{#            <div id="toolbar" class="btn-group">#}
{#                <button id="btn_add" type="button" class="btn btn-primary"#}
{#                        onclick="location.href='{% url 'project:project_add' %}'">#}
{#                    <span class="glyphicon glyphicon-plus" aria-hidden="true"></span>#}
{#                    新增#}
{##}
{#                </button>#}
{#                <button id="btn_edit" type="button" class="btn btn-primary">#}
{#                    <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>#}
{#                    修改#}
{#                </button>#}
{#                <button id="btn_delete" type="button" class="btn btn-primary">#}
{#                    <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>#}
{#                    删除#}
{#                </button>#}
{#            </div>#}
{#            <table id="tb" class="table table-bordered">#}
{#                <thead>#}
{#                <tr>#}
{#                    <th><input class="checkbox-row" type="checkbox"></th>#}
{#                    <th>{{ obj_form.name.label }} </th>#}
{#                    <th>{{ obj_form.type.label }}</th>#}
{#                    <th>创建人</th>#}
{#                    <th>{{ obj_form.detail.label }}</th>#}
{#                    <th>创建时间</th>#}
{#                    <th>修改时间 </th>#}
{#                    <th>操作</th>#}
{#                </tr>#}
{#                </thead>#}
{#                <tbody>#}
{#                {% for p in obj %}#}
{#                    <tr>#}
{#                        <td><input class="checkbox-row" type="checkbox"></td>#}
{##}
{#                        <td><a href="{% url 'project:project_detail' p.id %} " >{{ p.name }}</a></td>#}
{#                        <td>{{ p.get_type_display }}</td>#}
{#                        <td>{{ p.creator }}</td>#}
{#                        <td>{{ p.detail }}</td>#}
{#                        <td>{{ p.add_time }}</td>#}
{#                        <td>{{ p.edit_time }}</td>#}
{#                        <td><input id="sync" type="button" class="button" value={{ p.id }} ></td>#}
{#                    </tr>#}
{#                    <script>#}
{#                $("#sync").click(function () {#}
{#                    $.ajax({#}
{#                        url: "{% url 'project:project_sync' %}",#}
{#                        type:'POST',#}
{#                        data: {'project_id':$("#sync")},#}
{#                        success:function () {#}
{#                            $("#sync").value="已同步";#}
{#                            alert('sync success!');#}
{##}
{#                        }#}
{##}
{#                    })#}
{##}
{#                })#}
{#            </script>#}
{#                {% endfor %}#}
{##}
{#                </tbody>#}
{##}
{#            </table>#}
{#            <nav aria-label="Page navigation">#}
{#                <ul class="pagination">#}
{#                    {% if  obj.previous_page_number > 0 %}#}
{#                        <li>#}
{#                            <a href="?page={{ obj.previous_page_number }}" aria-label="Previous">#}
{#                                <span aria-hidden="true">«</span>#}
{#                            </a>#}
{#                        </li>#}
{#                    {% endif %}#}
{##}
{#                    {% for page_num in obj_list %}#}
{#                        {% if page_num == obj.number %}#}
{#                            <li class="active"><a href="?page={{ page_num }}">{{ page_num }}</a></li>#}
{#                        {% else %}#}
{#                            <li><a href="?page={{ page_num }}">{{ page_num }}</a></li>#}
{#                        {% endif %}#}
{#                    {% endfor %}#}
{##}
{#                    {% if obj.has_next %}#}
{#                        <li>#}
{#                            <a href="?page={{ obj.next_page_number }}" aria-label="Next">#}
{#                                <span aria-hidden="true">»</span>#}
{#                            </a>#}
{#                        </li>#}
{#                    {% endif %}#}
{#                </ul>#}
{#            </nav>#}
{##}
{##}
{#        </div>#}
    <table id="DataTable" class="table table-bordered tab-content">
    <script>
        $(function () {
            //1 初始化Table
            var oTable=new TableInit();
            oTable.Init();

            //2 初始化Button的点击事件
            var oButtonInit=new ButtonInit();
            oButtonInit.Init();

        });

        var TableInit = function () {
            var oTableInit=new Object();
            //初始化Table
            oTableInit.Init=function () {
                $("#DataTable").bootstrapTable({
                    url:"{% url 'project:project_list_json' %}",
                    method:'get',
                    toolbar:'#toolbar',
                    striped:true,
                    cache:false,
                    pagination:true,
                    sortable:false,
                    sortOrder:"asc",
                    queryParams:oTableInit.queryParams,
                    sidePagination:"server",
                    responseHandler:oTableInit.responseHandler,
                    pageNumber:1,
                    pageSize:5,
                    pageList: [5,25,50,100],
                    search:true,
                    strictSearch: true,
                    showColumns: true,                  //是否显示所有的列
                    showRefresh: true,                  //是否显示刷新按钮
                    minimumCountColumns: 2,             //最少允许的列数
                    clickToSelect: true,                //是否启用点击选中行
                    height: 500,                        //行高，如果没有设置height属性，表格自动根据记录条数觉得表格高度
                    uniqueId: "ID",                     //每一行的唯一标识，一般为主键列
                    showToggle:false,                    //是否显示详细视图和列表视图的切换按钮
                    cardView: false,                    //是否显示详细视图
                    detailView: false,                   //是否显示父子表
                    columns: [{
                        checkbox: true
                    }, {
                        field: 'name',
                        title: '项目名称'
                    }, {
                        field: 'type',
                        title: '项目类型'
                    },
                        {
                        field: 'creator.username',
                        title: '创建人'
                    }, {
                        field: 'add_time',
                        title: '创建时间'
                    }, {
                        field: 'edit_time',
                        title: '修改时间'
                    }, ]
                });
            };
            oTableInit.responseHandler=function(res){
                return {
                    "rows":res.results,
                    "total":res.count,
                }
            };
            oTableInit.queryParams = function (params) {
            var temp = {   //这里的键的名字和控制器的变量名必须一直，这边改动，控制器也需要改成一样的
                limit: params.limit,   //页面大小
                offset: params.offset,  //页码
                {#departmentname: $("#txt_search_departmentname").val(),#}
                {#statu: $("#txt_search_statu").val()#}
            };
            return temp;
        };
        return oTableInit;
    };


    var ButtonInit = function () {
        var oInit = new Object();
        var postdata = {};

        oInit.Init = function () {
            //初始化页面上面的按钮事件
        };

        return oInit;
};


    </script>
    </table>
    </div>
{% endblock %}
